{% extends "mytxs/base.html" %}
{% load mytxsTags %}

{% block content %}

{% block beforeSjekkheftetContent %}{% endblock %}

{% block sjekkheftetContent %}

{% if grupperinger|length > 1%}
<div id="sjekkheftetNavigator" class="my-2 flex flex-row justify-between w-[56rem]">
    {% for gruppenavn, gruppe in grupperinger.items %}
    <div>
        <h2 class="text-3xl">{{ gruppenavn|capfirst }}</h2>

        {% for medlem in gruppe %}
        <a class="text-sm" href="#m_{{ medlem.pk }}">{{ medlem.navn }}</a><br>
        {% endfor %}
    </div>
    {% endfor %}
</div>
{% endif %}

{% for gruppenavn, gruppe in grupperinger.items %}

{% if gruppenavn %}
<h2 class="text-3xl">{{ gruppenavn|capfirst }}: </h2>
{% endif %}

{% for medlem in gruppe %}
<br>
<div id="m_{{ medlem.pk }}" class="flex flex-row space-x-2 w-[56rem] p-2 backdrop-brightness-110 rounded-xl">
    {% if medlem.bilde %}
    <img src="{{ medlem.bilde.url }}" class="h-44 aspect-[139/169] object-cover align-top border-2 border-black">
    {% else %}
    <div class="h-44 aspect-[139/169] object-cover align-top border-2 border-black"></div>
    {% endif %}

    <ul>
        <li class="text-2xl">{{ medlem.navn }}
            {% if user.medlem.navBar.medlemListe %} <a class="text-sm" href="{% url 'medlem' medlem.pk %}">Rediger</a> {% endif %}
        </li>
        {% if request.resolver_match.kwargs.gruppe == 'Pirum' or request.resolver_match.kwargs.gruppe == 'Knauskoret' or request.resolver_match.kwargs.gruppe == 'Candiss' %}
        <li>Tatt opp: {{ medlem.K }}</li>
        {% else %}
        <li>Karantenekor: {{ medlem.K }}</li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:0 %}
        <li>Fødselsdato: {{ medlem.fødselsdato|date }}</li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:1 %}
        <li>Epost: <a href="mailto:{{ medlem.epost }}">{{ medlem.epost }}</a></li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:2 %}
        <li>Telefon: <a href="tel:{{ medlem.tlf|cut:' ' }}">{{ medlem.tlf }}</a></li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:3 %}
        <li>Studie eller jobb: {{medlem.studieEllerJobb}}</li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:4 %}
        <li>Bostedsadresse: {{medlem.boAdresse}}</li>
        {% endif %}
        {% if medlem.sjekkhefteSynlig|bitIs1:5 %}
        <li>Foreldreadresse: {{medlem.foreldreAdresse}}</li>
        {% endif %}

        {% ifAll %}<li>Verv: {% ifAll %}
            {% for vervInnehavelse in medlem.vervInnehavelser.all %}
            {% if vervInnehavelse.aktiv and not vervInnehavelse.verv.stemmegruppeVerv and vervInnehavelse.verv.kor.kortTittel == request.resolver_match.kwargs.gruppe %} 
            <span>{{ vervInnehavelse.verv }}</span>
            {% endif %}
            {% endfor %}
        {% ifAll %}</li>{% endIfAll%}

        {% ifAll %}<li>Dekorasjoner: {% ifAll %}
            {% for dekorasjonInnehavelse in medlem.dekorasjonInnehavelse.all %}
            {% if dekorasjonInnehavelse.dekorasjon.kor.kortTittel == request.resolver_match.kwargs.gruppe %}
            <span> {{ dekorasjonInnehavelse.dekorasjon }}</span>
            {% endif %}
            {% endfor %}
        {% ifAll %}</li>{% endIfAll %}
    </ul>
</div>
{% endfor %}

{% endfor %}

<br><a href="{% setURLParams vcard='true' %}">Last ned vCard for alle på siden</a>
<span title="For å laste ned alle på iphone, trykk del knappen på popupen, og åpne i kontakter. 
Da får du opp en liste av vcards der du kan importere alle.">(?)</span>

{% endblock%}

{% endblock %}